# 噪声抑制

### 噪声分类

#### 冲激噪声

冲激噪声的时域波形是类似于冲激函数那样的窄脉冲，常见的消除冲激噪声的方式有两种：

1. 对带噪语音信号的幅值求均值，将该均值作为判断的标准，超过该标准的视作噪声，在时域将其滤除。
2. 当噪声不太密集的时候，可以通过某些点内插的方法避开或者平滑掉冲激点，从而从语音信号中去掉冲击噪声。

#### 周期噪声

常见的噪声是50Hz的交流电产生的周期噪声。在频谱图上展现为离散的窄谱。可以采用陷波器将其去除掉。

#### 宽带噪声

说话时同时伴随着呼吸引起的噪声、随机噪声源产生的噪声以及量化噪声等都可视为宽带噪声。宽带噪声的特点是噪声频谱遍布于整个语音信号频谱中，一般采用非线性方法滤除。

#### 语音干扰

干扰语音和待传语音信号同时在一个信道中传输所造成的语音干扰。区别有用语音和干扰语音的基本方法是利用其基音差别。一般情况下两种语音的基音不同，也不成整数倍，因此可以用梳妆滤波器提取基音和各谐波。



### 原理

#### 干扰相减降噪技术

为了降低信号在传输过程中的噪声，改善语音传输质量，大多会采用三种通用的语音增强方法。首先是**干扰相减法**，即通过减掉噪声频谱来抑制噪声；其次是**谐波频率抑制法**，即利用语音增强的方法来完成减噪，基于噪声的周期性原理，利用谐波噪声的自适应梳状滤波实施基频跟踪来完成降噪；第三是**利用声码器再合成法**，它利用迭代法，在语音建模的基础上，估计模型参数，用描述语音信号的方法再重新合成无噪声信号。

**单通道语音增强系统必须在无语音期间**，也就是在只有背景噪声存在时估计噪声的特性。通过**语音启动检测器(VAD)采集有效的语音源和噪音源**，然后利用噪声相减算法实现降噪。基于**声音语音的周期性**，时域自适应噪声抵消法可以通过产生参考信号而加以利用。其中，参考信号是延迟主信号一个周期形成的，需要有复杂的间距估计算法。在语音帧内利用FFT，用估计的噪声幅值频谱相减，并逆变换这个相减后的频谱幅值，再利用原始噪音的相位，求出有噪音短时幅值和相位频谱。增强步骤一帧接一帧地完成。此方法先把污染的语音利用带通滤波器组分解成不同的频率组，随后每个分波段的噪声功率在无语音期间被估计出来。通过利用衰减因子可以获得噪声抑制，其中衰减因子相对应于每个分波段估计噪声功率比上的瞬时信号功率。

#### 谱相减降噪技术

目前，多数的通信减噪都是使用DSP来完成的，主要是使用FFT降低噪声。其中，频谱相减提供了有效的计算方法，通过从有噪声语音谱中减去噪声频谱，即增强了语音，又降低了噪声。有噪声语音被分段，并且被设置窗口，每个数据窗口的FFT均被执行，并且幅值频谱被计算出来。VAD用来检测输入的语音信号。在非语音段，噪声频谱将会被估计出来，并存入缓存区，再通过算法使得缓冲器内的数据衰减，从而使噪声减小。在非语音期间，有两种方法产生输出：用固定因子衰减输出或设置输出为0。在非语音帧期间具有某种残余噪声(舒适噪声)，可输出比较高的语音质量，原因是在语音帧期间，噪声局部地被语音屏蔽，它的幅值将会在非语音段上被存在的相同量值的噪声所平衡。在语音段上设置输出为0，具有放大噪声的效果，因此在非语音期间，最好通过固定因子衰减噪声。幅值与语音段上可觉察的噪声特性，以及噪声段上可觉察的噪声之间必须保持平衡，所以不希望的音响效果，如嗡嗡声、咔嗒声、抖动声、语音信号的模糊不清等，均可以避免。

在描述算法之前，先设置一些参数，并做数据分析。首先假设背景噪声是平稳的，并且在语音段内，使其希望幅值频谱出现在不变的语音段之前。如果环境是变化的，则在语音帧开始之前，有足够的时间去估计背景噪声的新幅值频谱。对于缓慢变化的噪声算法，需要根据VAD参数确定语音是否已经终止，同时估计新的噪声影响，然后利用频谱相减法，就可以使得噪声明显下降。

### 维纳滤波器



### 最小均方误差（MMSE）估计器



### 谱减法

#### 原理

谱相减方法是基于人的感觉特性，即语音信号的短时幅度比短时相位更容易对人的听觉系统产生影响，从而对语音短时幅度谱进行估计，适用于受加性噪声污染的语音。

处理宽带噪声的最通用技术是谱相减法，即从带噪语音估值中减去噪声频谱估值，从而得到纯净语音的频谱。由于人耳对语音频谱分量的相位不敏感，因而这种方法主要针对短时幅度谱。所谓“谱相减” 就是从输入信号的幅度谱中减去估计得来的噪声平均幅度谱，其效果相当于在变换域对带噪信号进行了某种均衡化处理。相对于其它方法，谱相减法引入的约束条件最少，物理意义最直接，运算量小，而且经过改进后效果也较好。

传统的谱减法即在频域将带噪语音的功率谱减去噪声的功率谱，得到语音的功率谱估计， 开方后就得到语音幅度估计，将其相位恢复后再采用逆傅立叶变换恢复时域信号。考虑到人耳对相位的感觉不灵敏，相位恢复时所采用的相位是带噪语音的相位信息。

#### 基本谱减法算法

基本谱减算法的思想是假设在加性噪声与短时平稳的语音信号相互独立的条件下，从带噪语音的功率谱中减去噪声功率谱，从而得到较为纯净的语音频谱。

![](.\png\谱减法算法.png)

根据人耳对相位变化不敏感这一特点，可以用原带噪语音信号y(t)的相位谱来代替估计之后的语音信号的相位谱，从而可以得到降噪后的语音时域信号。基本谱减算法的原理图如图3.2.1所示。

![](.\png\谱减法算法原理图.png)

#### 几种改进型谱减法算法

##### 非线性谱减

Berouti等人提出的谱减算法，假设了噪声对所有的频谱分量都有同等的影响，继而只用了一个过减因子来减去对噪声的过估计。现实世界中的噪声并非如此，这意味着可以用一个频率相关的减法因子来处理不同类型的噪声。

##### 多带谱减法

在多带算法中，将语音频谱划分为N个互不重叠的子带，谱减法在每个子带独立运行。将语音信号分为多个子带信号的过程可以通过在时域使用带通滤波器来进行，或者在频域使用适当的窗。通常会采用后一种办法，因为实现起来有更小的运算量。

多带谱减与非线性谱减的主要区别在于对过减因子的估计。多带算法针对频带估计减法因子，而非线性谱减算法针对每一个频点，导致频点上的信噪比可能有很大变化。这种剧烈变化是谱减法中所遇到的语音失真（音乐噪声）的原因之一。相反，子带信噪比变化则不会特别剧烈。

##### MMSE谱减算法

上面的方法中，谱减参数alpha和beta通过实验确定，无论如何都不会是最优的选择。MMSE谱减法能够在均方意义下最优地选择谱减参数。

##### 扩展谱减法

基于自适应维纳滤波与谱减原理的结合。维纳滤波用于估计噪声谱，然后从带噪语音信号中减去该噪声谱。

##### 自适应增益平均的谱减

谱减法中导致音乐噪声的两个因素在于谱估计的大范围变化以及增益函数的不同。对于第一个问题，Gustafsson等人建议将分析帧划分为更换小的子帧以得到更低分辨率的频谱。子帧频谱通过连续平均以减小频谱的波动。对于第二个问题Gustafsson等人提出使用自适应指数平均，在时间上对增益函数做平滑。此外，为了避免因使用零相位增益函数导致的非因果滤波问题，Gustafsson等人建议在增益函数中引入线性相位。

##### 基于感知特性的谱减

前面提到的方法，谱减参数要么是通过实验计算短时信噪比得到，要么是通过最优均方误差得到，均没有考虑听觉系统的特性，该算法的主要目的是使残余噪声在听觉上难以被察觉。利用了人类听觉系统改进系统的可懂度（即人耳的掩蔽效应）。







AnyChat的噪音抑制技术原理是将实时采样的数字信号进行频谱分析，这样我们就能分析背景噪声响应的强度和频谱分布，然后根据这个模型就能设计一个滤波器，当有人讲话的时候，同时做信号分析，根据分析，ANC就能分析出讲话者的频谱，那么根据这些背景噪音和讲话者的频谱，这个滤波器根据两个信号的对比实时的改变，让讲话者声音频谱通过，对背景噪声的频谱进行抑制，降低其能量，比如说降低15到20个分贝，就很明显可以感觉体验到噪音抑制的效果。



### WebRTC 噪声抑制算法

见  `WebRTC的噪声抑制（noise suppression，NS）算法.html`

## 硬件

### 芯片实现的噪声原理

- 模拟芯片降噪
- 数字DSP技术降噪



### 近场

近距离的通话/录音，比如手机通讯的手持通话模式，记者采访录音。

需要较强的环境噪声抑制，包括稳态噪声和非稳态噪声的抑制。

#### 特点

1. 由于人声离麦克风比较近，所以输入信号的SNR信噪比比较高。
2. 有用的信号源一般情况下方向比较固定，比如手机通话时，发声部位相对手机下部是相对固定的。
3. 要求的噪声抑制的能力比较强，除了稳态噪声之外要求消除离麦克风相对较远的非稳态噪声包括音乐，babble noise 等。

#### 抑制算法

##### 模拟噪声抑制

###### 模拟噪声抑制技术A

模拟噪声抑制的基本原理是通过时间域内信噪比SNR的差异来模拟实现VAD技术。以下图为例，可以很看出当人在讲话的时候，Mic检测到的信号会明显比没有人讲话或者讲话的间歇期的信号大得多。根据我们前面的讨论，以人讲话的声压为76dB为例，一般的环境中，环境噪声是小于60dB的，这样对60dB及以下的声音进行一定的衰减，而对60dB以上的声音不衰减，这样就可以实现降噪。

**优点**

电路简单，价格便宜。

**缺点**

1. 通话的过程中噪声和人声是混在一起的，不能起到降噪的作用
2. 当噪声大到一定程度后，芯片完全不能起到噪声抑制的作用
3. 信号源离开麦克风一定距离后，输出会急剧的降低，从而把人声和噪声一起抑制掉。

###### 模拟技术噪声抑制B

这种噪声抑制技术比A相比有了一定的改进，它的噪声抑制的斜率和门限值都是可调的，但是基本原理与A相同，只适用于噪声比较弱，人声比较强，信噪比SNR比较好的场合。

###### 模拟技术噪声抑制C ---**波束形成**

利用硬件电路实现Beamformer（波束形成），其中的一个麦克风用来主要采集人声，另外一个主要采集噪声，这样保证在某个角度的人声得到放大而其他方向的声音被抑制。

**优点**

与前面提到的两种主要依靠声压的大小区别（SNR）来施以不同的衰减的方法不同的是，这个通过模拟固定的麦克风的不同的传递函数，通过硬件对两个麦克风的信号以一定的规律相减来实现降噪，在一定条件（麦克风摆放位置，灵敏度匹配都在最佳）下效果比前面两种模拟的方法效果更好。

**缺点**

1. 对麦克风的摆放位置，指向性有严格的限制，比如有些解决方案推荐主麦克风使用指向性的麦克风来提高噪声抑制的效果。
2. 实现降噪后的语音音质较差，其原因是由于这种算法的出发点是通过模拟固定的摆放位置的传递函数，来实现某一个角度的声音的拾取而忽略其他方向的声音。这种方法就决定了其本身是以噪声为处理对象，忽略了人的声音的增强。
3. 由于这种方法只突出某一个特定方向的声音，所以当目标声源离开这个方向后声音会急剧降低。

##### 基于时间域，空间域和频率域的语音增强的噪声抑制

时间域是指基于VAD(voice activity detection),DSP通过判断人讲话的时候与不讲的时候或者停顿的期间的频率分布规律来判断人声与噪声的基本规律从而来实现降噪。

空间域是指通过判断**相位**来判断人声的方向和能量来实现噪声和人声的分离从而实现降噪。

频率域是指人声的频谱发布于噪声的频谱发布是有一定差距的，这时候可以通过以下统计规律来把麦克风信号中的一些特定频谱的噪声抑制掉。

###### 优点

人声的保真度非常好，噪声抑制效果较明显，并且不受方向的限制，可以实现360度的人声拾取而不影响降噪效果，是目前性能最好的噪声抑制算法之一。

###### 缺点

在噪声的声压特别大的时候（>100dB SPL）时噪声抑制的效果比第一种算法的效果稍差一点。另外就是算法相对很复杂，对参数变化敏感，包括麦克风的性能，摆放位置的都很敏感，调试起来很麻烦。



### 远场

远距离通话/拾音场合，比如同步录播系统，监控，会议系统等。

需要的是较弱的环境噪声抑制，以抑制稳态噪声为主。



